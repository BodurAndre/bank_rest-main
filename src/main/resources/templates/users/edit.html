<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è - Bank Cards</title>
    <link rel="stylesheet" th:href="@{/css/cards.css}">
</head>
<body>
    <div class="header">
        <h1>‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</h1>
        <div class="header-actions">
            <a href="/users" class="btn btn-secondary">‚Üê –ù–∞–∑–∞–¥ –∫ —Å–ø–∏—Å–∫—É</a>
            <a href="/" class="btn btn-secondary">üè† –ù–∞ –≥–ª–∞–≤–Ω—É—é</a>
            <a href="/logout" class="btn btn-secondary">–í—ã–π—Ç–∏</a>
        </div>
    </div>
    
    <div class="container">
        <!-- –°—Ç–∞—Ç—É—Å–Ω—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è -->
        <div th:if="${errorMessage}" class="status-notification" th:data-message="${errorMessage}" data-type="error"></div>
        
        <form th:action="@{/users/{id}/edit(id=${user.id})}" method="post" th:object="${user}" class="user-form">
            <div class="form-section">
                <h3>üë§ –û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h3>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="firstName">–ò–º—è *</label>
                        <input type="text" id="firstName" th:field="*{firstName}" required 
                               placeholder="–í–≤–µ–¥–∏—Ç–µ –∏–º—è" />
                    </div>
                    <div class="form-group">
                        <label for="lastName">–§–∞–º–∏–ª–∏—è *</label>
                        <input type="text" id="lastName" th:field="*{lastName}" required 
                               placeholder="–í–≤–µ–¥–∏—Ç–µ —Ñ–∞–º–∏–ª–∏—é" />
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="email">Email *</label>
                    <input type="email" id="email" th:field="*{email}" required 
                           placeholder="user@example.com" />
                </div>
                
                <div class="form-group">
                    <label for="role">–†–æ–ª—å *</label>
                    <select id="role" th:field="*{role}" required>
                        <option value="USER" th:selected="${user.role.name() == 'USER'}">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</option>
                        <option value="ADMIN" th:selected="${user.role.name() == 'ADMIN'}">–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä</option>
                    </select>
                </div>
            </div>
            
            <div class="form-section">
                <h3>üîê –°–º–µ–Ω–∞ –ø–∞—Ä–æ–ª—è</h3>
                <p class="form-help">–û—Å—Ç–∞–≤—å—Ç–µ –ø–æ–ª—è –ø—É—Å—Ç—ã–º–∏, –µ—Å–ª–∏ –Ω–µ —Ö–æ—Ç–∏—Ç–µ –º–µ–Ω—è—Ç—å –ø–∞—Ä–æ–ª—å</p>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="newPassword">–ù–æ–≤—ã–π –ø–∞—Ä–æ–ª—å</label>
                        <input type="password" id="newPassword" name="newPassword" 
                               minlength="6" placeholder="–ú–∏–Ω–∏–º—É–º 6 —Å–∏–º–≤–æ–ª–æ–≤" />
                    </div>
                    <div class="form-group">
                        <label for="confirmPassword">–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –ø–∞—Ä–æ–ª—è</label>
                        <input type="password" id="confirmPassword" name="confirmPassword" 
                               placeholder="–ü–æ–≤—Ç–æ—Ä–∏—Ç–µ –ø–∞—Ä–æ–ª—å" />
                    </div>
                </div>
            </div>
            
            <div class="form-section">
                <h3>üìã –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h3>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="dateOfBirth">–î–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è</label>
                        <input type="date" id="dateOfBirth" th:field="*{dateOfBirth}" />
                    </div>
                    <div class="form-group">
                        <label for="gender">–ü–æ–ª</label>
                        <select id="gender" th:field="*{gender}">
                            <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –ø–æ–ª</option>
                            <option value="Male" th:selected="${user.gender == 'Male'}">–ú—É–∂—Å–∫–æ–π</option>
                            <option value="Female" th:selected="${user.gender == 'Female'}">–ñ–µ–Ω—Å–∫–∏–π</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="country">–°—Ç—Ä–∞–Ω–∞</label>
                    <input type="text" id="country" th:field="*{country}" 
                           placeholder="–†–æ—Å—Å–∏—è" />
                </div>
            </div>
            
            <div class="form-actions">
                <button type="submit" class="btn btn-primary">‚úÖ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è</button>
                <a href="/users" class="btn btn-secondary">‚ùå –û—Ç–º–µ–Ω–∞</a>
            </div>
        </form>
    </div>

    <script th:src="@{/js/cards.js}"></script>
    
    <script>
        // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å—Ç–∞—Ç—É—Å–Ω—ã—Ö —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
        document.addEventListener('DOMContentLoaded', function() {
            const errorNotification = document.querySelector('.status-notification[data-type="error"]');
            
            if (errorNotification) {
                const message = errorNotification.getAttribute('data-message');
                showStatusNotification(message, 'error');
            }
            
            // –í–∞–ª–∏–¥–∞—Ü–∏—è –ø–∞—Ä–æ–ª–µ–π
            const newPassword = document.getElementById('newPassword');
            const confirmPassword = document.getElementById('confirmPassword');
            
            function validatePasswords() {
                if (newPassword.value !== '' && confirmPassword.value !== '') {
                    if (newPassword.value !== confirmPassword.value) {
                        confirmPassword.setCustomValidity('–ü–∞—Ä–æ–ª–∏ –Ω–µ —Å–æ–≤–ø–∞–¥–∞—é—Ç');
                    } else {
                        confirmPassword.setCustomValidity('');
                    }
                } else if (newPassword.value !== '' && confirmPassword.value === '') {
                    confirmPassword.setCustomValidity('–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å');
                } else {
                    confirmPassword.setCustomValidity('');
                }
            }
            
            newPassword.addEventListener('input', validatePasswords);
            confirmPassword.addEventListener('input', validatePasswords);
        });
    </script>
</body>
</html>
